# 7주차 학습 내용

## JPA 개념
> JPA(Java Persistence API)는 자바 객체를 데이터베이스 테이블과 매핑하고, 데이터를 저장
> 저장·조회·수정·삭제(CRUD)할 수 있도록 도와주는 자바 표준 ORM API  

SQL을 직접 작성하지 않고도 자바 객체 중심으로 DB 작업이 가능하며, 유지보수성과 생산성이 크게 향상됨

### JPA와 JDBC의 차이란?
| 항목       | JDBC                      | JPA                                   |
|------------|---------------------------|----------------------------------------|
| 쿼리 작성  | 직접 SQL 작성             | JPQL 또는 메서드로 처리                |
| 코드량     | 많음 | 적음 (간결한 코드)                    |
| 객체-DB 매핑 | 수동                     | 자동                                   |
| 유지보수   | 어려움                    | 쉬움                                   |
| 트랜잭션   | 직접 처리                 | @Transactional 등으로 간편 처리 가능 |

### ORM이란 무엇이고 JPA가 ORM 프레임워크에서 어떤 역할을 하는지
- **ORM(Object-Relational Mapping)** 은 객체(Object)와 관계형 데이터(Relational)를 
매핑(Mapping)하는 기법
- 자바 객체와 DB 테이블을 1:1로 연결해 자동으로 SQL이 생성되도록 함
- JPA는 ORM을 구현한 자바 표준 인터페이스


## 엔티티
조직이 관리하고자 하는 데이터와 관련된 사용자 환경 속의 사람, 장소, 객체, 이벤트 또는 개념
### 엔티티 필수 어노테이션의 종류는?
1. ```@Entity```  
해당 클래스가 JPA에서 관리할 엔티티임을 지정
2. ```@Id```  
기본 키를 지정
3. ```@GeneratedValue```  
기본 키 자동 생성 방식 지정
4. ```@Column```  
필드와 DB 컬럼을 매핑 (생략 가능)
### JPA에서 엔티티의 필수 조건은?
1. ```@Entity``` 어노테이션 필수
2. 기본 키 필수(```@Id```)
3. 기본 생성자(public 또는 protected)가 있어야 함
4. final 클래스, enum, 인터페이스는 안 됨
5. 필드는 private으로 선언하고 getter/setter 사용 권장
### 엔티티의 생명주기란?
1. 비영속(new/transient): 영속성 컨텍스트와 전혀 관계가 없는 상태
2. 영속(persistent): 영속성 컨텍스트에 저장된 상태
3. 준영속(detached): 영속성 컨텍스트에 저장되었다가 분리된 상태
4. 삭제(removed): 삭제된 상태
## 영속성 컨텍스트
- 엔티티를 영구 저장하는 환경
- 동일 트랜잭션 내에서 같은 객체를 반환하거나, 변경 감지, 쓰기 지연, 1차 캐시 등을 통해
성능 향상과 일관성 유지가 가능함
### 영속성 컨텍스트 상태의 종류는?
**1. 비영속 (New / Transient)**  
엔티티 객체가 생성되었지만, 아직 영속성 컨텍스트와 연결되지 않은 상태. 
이 상태의 엔티티는 영속성 컨텍스트의 어떤 관리도 받지 않으며, 데이터베이스에도 저장되지 않음  
**2. 영속 (Managed / Persistent)**    
엔티티 객체가 영속성 컨텍스트에 저장되어 관리되는 상태.
영속 상태의 엔티티는 영속성 컨텍스트의 1차 캐시에 저장되고, 변경 감지 기능을 통해 
트랜잭션 커밋 시점에 데이터베이스에 반영될 수 있음  
**3. 분리 (Detached)**   
이전에 영속성 컨텍스트에 의해 관리되던 엔티티 객체가 더 이상 영속성 컨텍스트의 관리를 받지 않는 상태.
영속성 컨텍스트가 종료되거나, detach() 메서드를 호출하여 엔티티를 분리하면 이 상태가 됨.
분리된 엔티티는 영속성 컨텍스트의 변경 감지 기능을 활용할 수 없음.   
**4.삭제 (Removed)**  
엔티티 객체가 영속성 컨텍스트에서 삭제 대상으로 지정된 상태. 
remove() 메서드를 호출하면 엔티티는 삭제 상태가 되며, 트랜잭션 커밋 시점에 데이터베이스에서 해당 엔티티가 삭제됨.

## 연간관계
### 연간관계의 종류와 JPA에서의 표현법은?
| 관계 유형 | 설명                           | JPA 표현법     |
|-----------|--------------------------------|----------------|
| 1:1       | 하나의 객체가 하나의 객체를 참조 | `@OneToOne`    |
| 1:N       | 하나의 객체가 여러 객체를 참조   | `@OneToMany`   |
| N:1       | 여러 객체가 하나의 객체를 참조   | `@ManyToOne`   |
| N:N       | 다수 객체가 서로를 참조         | `@ManyToMany`  |